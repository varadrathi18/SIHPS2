<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opportunity Radar - Pune | SkillNavigator</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet.js for Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        #map { 
            height: 100%; 
            border-radius: 0.75rem;
            z-index: 10;
        }
        .leaflet-popup-content-wrapper {
            border-radius: 8px;
        }
        .leaflet-popup-content {
            font-family: 'Inter', sans-serif;
        }
        .opportunity-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .opportunity-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .active-card {
             border-color: #2563eb; /* blue-600 */
             border-width: 2px;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <div class="flex items-center space-x-4">
                    <img src="https://placehold.co/100x40/003366/FFFFFF?text=MSDE" alt="MSDE Logo" class="h-10">
                    <div class="flex items-center space-x-2">
                        <svg class="h-8 w-8 text-blue-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                           <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                       </svg>
                       <h1 class="text-2xl font-bold text-gray-800">SkillNavigator</h1>
                   </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-semibold text-gray-700">Pune Metropolitan Region</p>
                    <p id="current-time" class="text-xs text-gray-500"></p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Title -->
        <div class="text-center mb-8">
            <h2 class="text-3xl font-extrabold text-gray-900 tracking-tight">Hyper-Local Opportunity Radar</h2>
            <p class="mt-2 max-w-3xl mx-auto text-md text-gray-600">
                Explore upcoming industrial, infrastructure, and government projects to make strategic career choices. The hotspots below represent significant future demand for skilled professionals.
            </p>
        </div>

        <!-- Map container -->
        <div id="map-container" class="bg-white p-4 rounded-xl shadow-lg h-[60vh] mb-12">
            <div id="map"></div>
        </div>

        <!-- List of Opportunities -->
        <div>
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Project Details</h3>
            <div id="opportunity-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Opportunity cards will be dynamically inserted here -->
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-800 text-white mt-12">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center text-sm">
            <p>&copy; 2025 SkillNavigator | An initiative aligned with the National Skill India Mission.</p>
            <p class="text-slate-400 mt-1">Data is illustrative and for demonstration purposes only.</p>
        </div>
    </footer>

    <script>
document.addEventListener('DOMContentLoaded', () => {

    // --- DATA SIMULATION ---
    const opportunitiesData = [
        {
            id: 1,
            type: "INDUSTRIAL PROJECT",
            title: "New EV Battery Plant - Chakan MIDC",
            description: "A new 50-acre EV battery manufacturing plant is under construction by a leading global automaker. Expected to create over 800 technical jobs in the next 24 months, focusing on automated assembly and quality control.",
            skills_in_demand: ["CNC Operator", "Welding Technician", "Robotics Maintenance", "Quality Assurance Inspector"],
            latitude: 18.7525,
            longitude: 73.8340
        },
        {
            id: 2,
            type: "INFRASTRUCTURE PROJECT",
            title: "Pune Metro Line 3 Expansion - Hinjewadi",
            description: "The new 23km metro line connecting the Hinjewadi IT hub to the city center will require extensive electrical and signaling work, along with civil engineering support, over the next 3 years.",
            skills_in_demand: ["Advanced Electrical Wiring", "Electronics Technician", "Surveyor", "Construction Supervisor"],
            latitude: 18.5793,
            longitude: 73.7389
        },
        {
            id: 3,
            type: "GOVERNMENT INITIATIVE",
            title: "Public EV Charging Network - Phase 1",
            description: "Pune Municipal Corporation has approved a tender for installing 500 new public EV charging stations across the city. Installation is scheduled to begin in the next 6 months.",
            skills_in_demand: ["EV Charger Installation Specialist", "Solar Grid Integration", "Licensed Electrician"],
            latitude: 18.5204,
            longitude: 73.8567
        },
        {
            id: 4,
            type: "REAL ESTATE DEVELOPMENT",
            title: "Kharadi Tech Park Expansion",
            description: "A new 2 million sq. ft. commercial complex is approved for the Kharadi EON IT Park area, requiring skilled trades for construction and long-term facility management.",
            skills_in_demand: ["HVAC Technician", "Plumber", "Building Management Systems Operator", "Fire Safety Officer"],
            latitude: 18.5529,
            longitude: 73.9515
        }
    ];

    // --- SET CURRENT TIME ---
    const updateTime = () => {
        const timeEl = document.getElementById('current-time');
        if (timeEl) {
            timeEl.textContent = `Last updated: ${new Date().toLocaleString('en-IN', {
                day: '2-digit', month: 'short', year: 'numeric',
                hour: '2-digit', minute: '2-digit', hour12: true
            })}`;
        }
    };
    updateTime();
    setInterval(updateTime, 60000);

    // --- MAP INITIALIZATION ---
    const map = L.map('map').setView([18.5204, 73.8567], 11);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
        maxZoom: 19
    }).addTo(map);

    // --- ICONS ---
    const iconFactory = L.icon({ iconUrl: 'data:image/svg+xml;base64,...', iconSize: [38,38], iconAnchor: [19,38], popupAnchor: [0,-38] });
    const iconInfra = L.icon({ iconUrl: 'data:image/svg+xml;base64,...', iconSize: [38,38], iconAnchor: [19,38], popupAnchor: [0,-38] });
    const iconGov = L.icon({ iconUrl: 'data:image/svg+xml;base64,...', iconSize: [38,38], iconAnchor: [19,38], popupAnchor: [0,-38] });
    const iconRealEstate = L.icon({ iconUrl: 'data:image/svg+xml;base64,...', iconSize: [38,38], iconAnchor: [19,38], popupAnchor: [0,-38] });

    const getIconForType = (type) => {
        switch(type){
            case 'INDUSTRIAL PROJECT': return iconFactory;
            case 'INFRASTRUCTURE PROJECT': return iconInfra;
            case 'GOVERNMENT INITIATIVE': return iconGov;
            case 'REAL ESTATE DEVELOPMENT': return iconRealEstate;
            default: return new L.Icon.Default();
        }
    };

    // --- RENDER LIST & MARKERS ---
    const listContainer = document.getElementById('opportunity-list');
    const mapContainer = document.getElementById('map-container');
    const markers = [];

    opportunitiesData.forEach(opp => {
        // Create list card
        const card = document.createElement('div');
        card.className = 'opportunity-card flex flex-col bg-white p-5 rounded-lg shadow-md border-2 border-transparent';
        card.id = `card-${opp.id}`;
        const skillsQueryParam = encodeURIComponent(opp.skills_in_demand.join(','));

        card.innerHTML = `
            <div class="flex-grow">
                <p class="text-xs font-bold text-blue-700 uppercase tracking-wide">${opp.type}</p>
                <h3 class="text-lg font-bold text-gray-800 mt-1">${opp.title}</h3>
                <p class="text-sm text-gray-600 mt-2">${opp.description}</p>
            </div>
            <div class="mt-4 border-t border-gray-200 pt-3">
                <h4 class="text-sm font-semibold text-gray-800">Key Skills in Demand:</h4>
                <div class="flex flex-wrap gap-2 mt-2">
                    ${opp.skills_in_demand.map(skill => `<span class="bg-slate-200 text-slate-800 text-xs font-medium px-2.5 py-1 rounded-full">${skill}</span>`).join('')}
                </div>
            </div>
            <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
                <a href="learn_skills.html?skills=${skillsQueryParam}" target="_blank" class="w-full text-center bg-white text-blue-600 border border-blue-600 font-semibold py-2 px-3 rounded-lg hover:bg-blue-50 transition-colors">
                    Learn Key Skills
                </a>
                <button class="show-on-map-btn w-full bg-blue-600 text-white font-semibold py-2 px-3 rounded-lg hover:bg-blue-700 transition-colors" data-id="${opp.id}">
                    Show on Map
                </button>
            </div>
        `;
        listContainer.appendChild(card);

        // Create map marker
        const marker = L.marker([opp.latitude, opp.longitude], { icon: getIconForType(opp.type) }).addTo(map);
        marker.bindPopup(`<b>${opp.title}</b><br>${opp.type}`).on('click', () => {
            highlightCard(opp.id);
            document.getElementById(`card-${opp.id}`).scrollIntoView({ behavior: 'smooth', block: 'center' });
        });
        markers.push(marker);
    });

    // Fit all markers in view
    const group = L.featureGroup(markers);
    map.fitBounds(group.getBounds().pad(0.2));

    // --- CARD HIGHLIGHT FUNCTION ---
    const highlightCard = (id) => {
        document.querySelectorAll('.opportunity-card').forEach(c => c.classList.remove('active-card'));
        const selectedCard = document.getElementById(`card-${id}`);
        if(selectedCard) selectedCard.classList.add('active-card');
    };

    // --- SHOW ON MAP BUTTONS ---
    listContainer.addEventListener('click', (e) => {
        const button = e.target.closest('.show-on-map-btn');
        if(button){
            const id = button.dataset.id;
            const opp = opportunitiesData.find(o => o.id == id);
            if(opp){
                const marker = markers.find(m => m.getLatLng().lat === opp.latitude && m.getLatLng().lng === opp.longitude);
                if(marker){
                    map.flyTo([opp.latitude, opp.longitude], 14);
                    marker.openPopup();
                    highlightCard(id);
                    mapContainer.scrollIntoView({ behavior: 'smooth' });
                }
            }
        }
    });

});
</script>

</body>
</html>